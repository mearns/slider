<!DOCTYPE html >
<html>
    <head>
        <meta charset='utf-8' />

        <title>OOP Test</title>

    </head>
    <body>

        <script type='text/javascript' src='/res/script/class.js' ></script>

        <script type='text/javascript'>
        // <![CDATA[

            var Animal = Thing.subclass("Animal", {

                speach: function() {
                    return "Animal sound.";
                },

                speak: function() {
                    console.log(this.speach());
                },

                //XXX: FIXME: When binding parent methods, this.super that's available
                // there needs to be the appropriately higher level.
                //
                // E.g., when creating an instance of GenericAnimal, we bind this
                // method from the Animal class to the GenericAnimal object. It's
                // super object also has this object attached to it (bound to the
                // same GenericAnimal object), and because of _bindSuper, the super
                // object attached to it when that's run has Thing's getClassName
                // method attached, so it doesn't go forever.
                // But when invoking an inherited method, the super object needs
                // to be modified.
                getClassName: function() {
                    return "Animal: " + Thing.superDelegate(this).getClassName();
                }
            });

            var GenericAnimal = Animal.subclass("GenericAnimal", {
                speach: function() {
                    return "Generic " + Animal.superDelegate(this).getClassName();
                }
            });

            var SpecificAnimal = GenericAnimal.subclass("SpecificAnimal", {
                speach: function() {
                    return "Non-" + GenericAnimal.superDelegate(this).getClassName();
                }
            });


            var a = Animal.create();
            var g = GenericAnimal.create();
            var s = SpecificAnimal.create();
            
            console.log(a.speach());
            console.log(g.speach());
            console.log(s.speach());

            console.log("-----------------------------------------------");

            a.speak();
            g.speak();
            s.speak();

            console.log("-----------------------------------------------");

            //This should not be "Animal: Animal: Animal: SpecificAnimal".
            // It should just be "Animal: SpecificAnimal".
            console.log(s.getClassName());
        
        // ]]>
        </script>
    </body>
</html>

